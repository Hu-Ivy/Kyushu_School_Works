The shape of data is: (2000, 784)
The shape of label is: (2000,)
The shape of data is: (10000, 784)
The shape of label is: (10000,)
Data loading took 170.295777 seconds
The shape of the distance matrix is:
(10000, 2000)
Got 8971 / 10000 correct => accuracy: 0.897100 @ k=1
Classification took 2.015476 seconds
0: 0.8430
1: 0.9920
2: 0.5940
3: 0.5770
4: 0.5470
5: 0.4190
6: 0.7540
7: 0.7160
8: 0.4560
9: 0.6590
= Confusion matrix ===========
0843, 0030, 0005, 0003, 0000, 0014, 0078, 0002, 0020, 0005, 
0001, 0992, 0001, 0004, 0000, 0000, 0002, 0000, 0000, 0000, 
0098, 0147, 0594, 0037, 0009, 0001, 0033, 0020, 0055, 0006, 
0021, 0173, 0019, 0577, 0005, 0039, 0036, 0016, 0076, 0038, 
0094, 0128, 0002, 0001, 0547, 0001, 0057, 0022, 0019, 0129, 
0062, 0173, 0005, 0066, 0013, 0419, 0134, 0002, 0073, 0053, 
0102, 0116, 0009, 0000, 0002, 0010, 0754, 0001, 0004, 0002, 
0037, 0109, 0006, 0011, 0014, 0000, 0001, 0716, 0000, 0106, 
0020, 0271, 0028, 0040, 0008, 0052, 0079, 0013, 0456, 0033, 
0032, 0102, 0002, 0009, 0095, 0004, 0006, 0077, 0014, 0659, 
= Total Recognition accuracy ===========
TOTAL: 0.6557
Classification took 462.822850 seconds

New data loading took 0.111530 seconds
The shape of the distance matrix is:
(10000, 2000)
Got 8971 / 10000 correct => accuracy: 0.897100 @ k=1
Classification took 2.029312 seconds
0: 0.8430
1: 0.9920
2: 0.5940
3: 0.5770
4: 0.5470
5: 0.4190
6: 0.7540
7: 0.7160
8: 0.4560
9: 0.6590
= Confusion matrix ===========
0843, 0030, 0005, 0003, 0000, 0014, 0078, 0002, 0020, 0005, 
0001, 0992, 0001, 0004, 0000, 0000, 0002, 0000, 0000, 0000, 
0098, 0147, 0594, 0037, 0009, 0001, 0033, 0020, 0055, 0006, 
0021, 0173, 0019, 0577, 0005, 0039, 0036, 0016, 0076, 0038, 
0094, 0128, 0002, 0001, 0547, 0001, 0057, 0022, 0019, 0129, 
0062, 0173, 0005, 0066, 0013, 0419, 0134, 0002, 0073, 0053, 
0102, 0116, 0009, 0000, 0002, 0010, 0754, 0001, 0004, 0002, 
0037, 0109, 0006, 0011, 0014, 0000, 0001, 0716, 0000, 0106, 
0020, 0271, 0028, 0040, 0008, 0052, 0079, 0013, 0456, 0033, 
0032, 0102, 0002, 0009, 0095, 0004, 0006, 0077, 0014, 0659, 
= Total Recognition accuracy ===========
TOTAL: 0.6557
Classification took 470.323374 seconds

_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_1 (Conv2D)            (None, 28, 28, 28)        280       
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 26, 26, 28)        7084      
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 13, 13, 28)        0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 13, 13, 28)        0         
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 13, 13, 56)        14168     
_________________________________________________________________
conv2d_4 (Conv2D)            (None, 11, 11, 56)        28280     
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 5, 5, 56)          0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 5, 5, 56)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 1400)              0         
_________________________________________________________________
dense_1 (Dense)              (None, 448)               627648    
_________________________________________________________________
dropout_3 (Dropout)          (None, 448)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 10)                4490      
=================================================================
Total params: 681,950
Trainable params: 681,950
Non-trainable params: 0
_________________________________________________________________

Got 9999 correct, accuracy = 99.990000%

